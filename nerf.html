<!DOCTYPE html>
<html  >
<head>
  <!-- Site made with Mobirise Website Builder v5.9.6, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v5.9.6, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/d20-128x128-1.png" type="image/x-icon">
  <meta name="description" content="">
  
  
  <title>Sentry Nerf Gun</title>
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/socicon/css/styles.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">

  
  
  
</head>
<body>
  
  <section data-bs-version="5.1" class="menu menu2 cid-tm3DbuXwWe" once="menu" id="menu2-29">
    
    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
        <div class="container">
            <div class="navbar-brand">
                
                <span class="navbar-caption-wrap"><a class="navbar-caption text-primary display-7" href="index.html">Carlo Colizzi<br>Robotics Engineer</a></span>
            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav nav-dropdown" data-app-modern-menu="true"><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="index.html">Home</a></li>
                    <li class="nav-item dropdown open"><a class="nav-link link text-black text-primary dropdown-toggle display-4" href="index.html#gallery5-11" data-toggle="dropdown-submenu" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">My Works</a><div class="dropdown-menu" aria-labelledby="dropdown-704"><a class="text-black text-primary dropdown-item show display-4" href="nerf.html">BCI Controlled Prosthetics</a><div class="dropdown"><a class="text-black text-primary dropdown-item dropdown-toggle display-4" href="index.html#gallery5-11" data-toggle="dropdown-submenu" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">Automatic Chess</a><div class="dropdown-menu dropdown-submenu" aria-labelledby="dropdown-696"><a class="text-black text-primary dropdown-item display-4" href="chess.html">Home</a><a class="text-black text-primary dropdown-item display-4" href="chess-timeline.html">Timeline</a><a class="text-black text-primary dropdown-item display-4" href="chess-subsystems.html">Subsystems<br></a></div></div><a class="text-black text-primary dropdown-item show display-4" href="nerf.html">Sentry Nerf Gun</a><a class="text-black text-primary dropdown-item show display-4" href="rocketry.html">Rocketry</a><a class="text-black text-primary dropdown-item show display-4" href="rover.html">Autonomous RC Car</a><a class="text-black text-primary dropdown-item show display-4" href="comprobo-warmup.html">Controlling a Neato</a><a class="text-black text-primary dropdown-item show display-4" href="comprobo-localization.html">WIP: Neato Particle Filter</a><a class="text-black text-primary dropdown-item show display-4" href="index.html#gallery5-11">WIP: Covid-19 LFT Manufacturing</a></div></li><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="index.html#image1-b">About Me</a></li></ul>
                
                <div class="navbar-buttons mbr-section-btn"><a class="btn btn-black-outline display-4" href="index.html#form4-6">
                        Contact</a></div>
            </div>
        </div>
    </nav>
</section>

<section data-bs-version="5.1" class="header11 cid-tno0l7mlfR" id="header11-4u">

    

    
    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-6 image-wrapper">
                <img class="w-100" src="assets/images/side-view-1645x2048.jpg" alt="Mobirise Website Builder">
            </div>
            <div class="col-12 col-md">
                <div class="text-wrapper text-center">
                    <h1 class="mbr-section-title mbr-fonts-style mb-3 display-1"><strong>Sentry Nerf Gun</strong></h1>
                    <p class="mbr-text mbr-fonts-style display-7">Team: Gabby Blake, Ben Grant<br>October 2022</p>
                    <div class="mbr-section-btn mt-3"><a class="btn btn-secondary display-7" href="https://github.com/gabbyblake/computer_vision" target="_blank">GiyHub Repository</a></div>
                </div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content5 cid-tno0ACe1Kc" id="content5-4v">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                
                <p class="mbr-text mbr-fonts-style display-7">The goal for this project was to use computer vision to create a Nerf sentry gun. A sentry gun is a weapon<br>that is automatically aimed and fired at targets that are detected by sensors.1 We also wanted to mount this<br>Nerf gun on a Neato robot vacuum, so that our system could move around various locations autonomously.<br>Moreover, we decided to create two modes for our project: one that identifies, tracks, and aims at a specific<br>color, and one that uses facial recognition to do the same.</p>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="image1 cid-tno0OQO3OU" id="image1-4y">
    

    
    

    <div class="container">
        <div class="row align-items-center">
            <div class="col-12 col-lg-6">
                <div class="image-wrapper">
                    <img src="assets/images/envelope-609x471.jpg" alt="Mobirise Website Builder">
                    <p class="mbr-description mbr-fonts-style pt-2 align-center display-4">Figure 2: Work envelope of a typical<br>robotic arm</p>
                </div>
            </div>
            <div class="col-12 col-lg">
                <div class="text-wrapper">
                    <h3 class="mbr-section-title mbr-fonts-style mb-3 display-5">
                        <strong>Mechanical System Design</strong></h3>
                    <p class="mbr-text mbr-fonts-style display-7">We opted to use a Nerf Stryfe as the gun component in our<br>design, as it propels darts with electrically powered, opposed<br>flywheels. This meant that we would only need to actuate a<br>servo motor to pull the gun’s trigger and a relay to close the<br>flywheel circuit, which was a significantly easier option than<br>designing for a spring-powered gun requiring a lot of cocking<br>force.<br>We decided to mount the Nerf gun on a custom-made<br>pan/tilt turret with both axes driven by NEMA-17 step-<br>per motors. With this design, the sentry gun would be<br>able to hit targets in a semi-spherical targeting envelope<br>such as the one pictured to the left in figure 2. We de-<br>cided to 3D print this structure, as this method gave us<br>a high degree of flexibility and efficiency in our developing<br>stages.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="image2 cid-tno1KEZRyT" id="image2-4z">
    

    
    

    <div class="container">
        <div class="row align-items-center">
            <div class="col-12 col-lg-6">
                <div class="image-wrapper">
                    <img src="assets/images/bearing-1256x1005.png" alt="Mobirise Website Builder">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">Figure 3: 3D printable crossed-roller<br>bearing</p>
                </div>
            </div>
            <div class="col-12 col-lg">
                <div class="text-wrapper">
                    
                    <p class="mbr-text mbr-fonts-style display-7">Our most complex 3D-printed part was the crossed-roller bearing used to support and drive the pan-axis of the pan/tilt turret<br>(figure 3). This type of bearing can support both axial (thrust),<br>radial, and combined loads while remaining free-spinning. In<br>case we needed to install the pan/tilt stepper motors on the turret asymmetrically, we needed a low-cost, 3D-printed bearing<br>solution that could handle combined radial/axial loads without<br>binding.<br>We also set a design goal of making as few permanent<br>modifications to the Nerf gun as possible, so we designed our<br>components to fit onto the existing attachment rails of the<br>Stryfe.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content5 cid-tno0LLaaEk" id="content5-4w">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5"><strong>
                    Electrical System Design</strong></h4>
                <p class="mbr-text mbr-fonts-style display-7">The actuators we used in the Nerf Sentry system were:<br>• Two NEMA-17 stepper motors for driving both axes of the pan/tilt mount<br>• A 5v relay for controlling the Nerf gun’s flywheel motors<br>• A servo motor for pulling the Nerf gun’s trigger<br><br>Our goal for the electrical design of the project was to interface to have the entire Nerf Sentry system able to be controlled by means of a single Micro-USB serial connection. This goal necessitated the use of a microcontroller for controlling two A4988 stepper motor drivers, the relay, and the servo. We made use of a Raspberry Pi Pico running CircuitPython code to listen for serial commands and drive the actuators accordingly.</p>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="image3 cid-tno2tgmteu" id="image3-50">
    

    
    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/breadboard-wiring-diagram-2136x1824.png" alt="Mobirise Website Builder">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">
                        Figure 4: Wiring diagram</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content4 cid-tno2OznCle" id="content4-52">
    

    
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="title col-md-12 col-lg-10">
                <h3 class="mbr-section-title mbr-fonts-style align-center mb-4 display-5"><strong>CAD and Fabrication</strong></h3>
                
                
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="image4 cid-tno2MSJOD9" id="image4-51">
    

    
    

    <div class="container">
        <div class="row">
            <div class="col-12 col-lg-6">
                <div class="image-wrapper">
                    <img src="assets/images/trigger-puller2-1120x1120.png" alt="Mobirise Website Builder">
                    <p class="mbr-text mbr-fonts-style mt-2 align-center display-4">
                        Figure 5b: Trigger puller servo mount (front view)</p>
                </div>
            </div>
            <div class="col-12 col-lg-6">
                <div class="image-wrapper">
                    <img src="assets/images/trigger-puller-1120x1120.png" alt="Mobirise Website Builder">
                    <p class="mbr-text mbr-fonts-style mt-2 align-center display-4">
                        Figure 5a: Trigger puller servo mount (side view)</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="image2 cid-tno3yXxk4u" id="image2-53">
    

    
    

    <div class="container">
        <div class="row align-items-center">
            <div class="col-12 col-lg-6">
                <div class="image-wrapper">
                    <img src="assets/images/picam-mount-1256x1005.png" alt="Mobirise Website Builder">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">
                        Figure 6: Picam rail-mount</p>
                </div>
            </div>
            <div class="col-12 col-lg">
                <div class="text-wrapper">
                    
                    <p class="mbr-text mbr-fonts-style display-7">Firstly, we 3D printed an attachment for the back of<br>the gun which fits snugly onto a protrusion on the back<br>of the Nerf gun (figure 5). This served as an attached<br>housing for a servo motor to pull the Nerf gun’s trigger.<br>On one side of the housing, we have an anchor point for<br>one end of a string, which is then passed in front of the<br>trigger and tied to a gear arm on the servo. This way,<br>whenever the servo turned, the string would be pulled<br>and the trigger engaged.<br>After mounting this first attachment we used the rails<br>on the Nerf gun to mount a custom attachment for a<br>PiCam (figure 6).</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content5 cid-tno3BCE5hU" id="content5-54">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                
                <p class="mbr-text mbr-fonts-style display-7">Lastly, we made the actual pan/tilt structure. Again, we decided to use the rails on the gun to our advantage, using them as a mounting for the attachments. This was made so that the gun would rotate around its approximate center of mass, as to minimize stress on the motors running the pan/tilt interface. Furthermore, we also cut a hole into the middle of the print, so that the gun could freely spin and move without the cables getting in the way or getting tangled.</p>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="image3 cid-tno3CfFmWy" id="image3-55">
    

    
    

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-7">
                <div class="image-wrapper">
                    <img src="assets/images/pantilt2-2048x1763.jpg" alt="Mobirise Website Builder">
                    <p class="mbr-description mbr-fonts-style mt-2 align-center display-4">
                        Figure 7: Pan/tilt assembly</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content4 cid-tno4nraoHm" id="content4-56">
    

    
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="title col-md-12 col-lg-10">
                <h3 class="mbr-section-title mbr-fonts-style align-center mb-4 display-2">
                    <strong>Computer Vision Targeting</strong></h3>
                <h4 class="mbr-section-subtitle align-center mbr-fonts-style mb-4 display-7">We created two different object identification functions: one that uses color masking to identify a particular color, and one that uses face detection.</h4>
                
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content10 cid-tno5FK93NX" id="content10-57">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md">
                
                <h6 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5"><strong>
                    Face Detection</strong></h6>
            </div>
            <div class="col-md-12 col-lg-6">
                <p class="mbr-text mbr-fonts-style display-7">The face detection function, find faces(), uses OpenCV to convert the input to a binary image and an XML file to identify facial components in it. Some rectangles are then drawn around each identified face. During this stage, we encountered an unexpected behaviour: the script was identifying many smaller ”faces” in the image background, even when they weren’t there. To account for this, we decided to create a lower limit to how big the rectangles have to be for their content to be considered a face. Once we have identified the faces in the image, we take the center of the rectangle and consider that the centroid of the face. These coordinates are then passed down to the process centroid() function.</p>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content10 cid-tno5I4GduQ" id="content10-58">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md">
                
                <h6 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5"><strong>
                    Color Masking</strong></h6>
            </div>
            <div class="col-md-12 col-lg-6">
                <p class="mbr-text mbr-fonts-style display-7">The color masking function, find shapes(), works quite similarly to the face detection one. Again, we use OpenCV to convert to a binary image and identify the objects that match the color requirements, in our case red objects. We then find and return the centroid of these objects and pass the coordinates to the process centroid() function.</p>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="image2 cid-tno5ObC1jS" id="image2-59">
    

    
    

    <div class="container">
        <div class="row align-items-center">
            <div class="col-12 col-lg-4">
                <div class="image-wrapper">
                    <img src="assets/images/cam-1166x2048.jpg" alt="Mobirise Website Builder">
                    
                </div>
            </div>
            <div class="col-12 col-lg">
                <div class="text-wrapper">
                    <h3 class="mbr-section-title mbr-fonts-style mb-3 display-5">
                        <strong>Object Tracking</strong></h3>
                    <p class="mbr-text mbr-fonts-style display-7">The process centroid function receives the centroid (x- and y- coordinates) of the target as input and evaluates it. If the centroid is within the turret’s line of fire, represented by the centroid being within the bounds a small blue box fixed at the center of the camera frame, then velocity commands are sent to the pan and tilt motors of<br>the turret to aim it at its target. These velocity commands are determined through PD controllers and sent over serial (further explained in the next section Thinking and Acting). If after receiving the target centroid coordinates, it is determined that the target is already within the aiming box, the command to fire is sent over serial to the motor that controls the trigger of the turret.<br><br><strong>Thinking and Acting<br></strong>Once we have a set of coordinates for the centroid of the object we’re tracking, we used a PD controller for both the pan and tilt motors respectively to move the camera until our target was at the center of the image. A PID controller is a proportional-integral-derivative control loop mechanism that is used to minimize the error between an measured process variable and desired setpoint. The proportional constant determines the amplitude of oscillation that occurs when the process variable approaches the setpoint value, goes past it, and then changes its values to go towards that setpoint value again before repeating the process over and over until a minimum error is reached. This process can sped up though by changing the integral and derivative constants to dampen this oscillation quickly and effectively. We did not change the integral constant, so it is more accurate to say we implemented a PD controller. The derivative constant was used to dampen the oscillation caused by the P constant. In the end the values of the constants were K p is -0.001 and K d is 0.0001 and the limits of the controllers were -1 to 1 m/s as we did not want the velocities of the motors to be any faster than this 1 m/s in either direction. The turret’s camera was physically located above the barrel of the gun so while the camera was locking in on faces, the turret would fire further down at the chest of the target<br>individual.<br><br><br></p>
                </div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content5 cid-tno5QFY6g6" id="content5-5a">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5"><strong>
                    Discussion</strong></h4>
                <p class="mbr-text mbr-fonts-style display-7">When working on this project we have run into various unexpected problems. One of these was the fact that whenever the script detects more than one face, the centroid will be at the average location of these. In order to correct this, we decided to add some code to use only the first identified face as the centroid.<br><br>One other issue that we ran into was serial communication with the Pi and the Pi Pico and getting that communication to work through ROS. We were able to make these mechanisms work independently, for example the facial recognition, color masking and controlling the motors through keyboard commands all worked, but we struggled to connect the pieces. After many hours of trying to do this, we decided to cut out the middle man and scrap the Neato and the ROS architecture, putting all the code into one module and running one program. With this decision, we were able to integrate the turret and computer vision code, and the turret was able to move according to what it saw through the camera.</p>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content5 cid-tno5S5e8hG" id="content5-5b">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5"><strong>
                    Future Improvements</strong></h4>
                <p class="mbr-text mbr-fonts-style display-7">Although this project turned out great, there is still lots of room for improvements. If more time was available, we would have integrated our sentry Nerf with the Neato robots, allowing our machine to move around a location autonomously. This was in our initial plan but due to unexpected issues with running our code on a Raspberry Pi and using ROS at the same time we decided to develop our project without this capability. Another improvement that we would focus on is the facial recognition. Although it does work as intended, the algorithm still occasionally identifies faces where there aren’t any. Having more time to work on this would allow us to tweak our code, resulting in a more accurate face detection. Lastly, if we had more time we would also work on integrating our code to run without the need of a laptop. Although the Pi is technically able to run the code, it is very slow and therefore unusable for our project. Possibly including multi-threading and overclocking could allow us to optimise performance on the Pi.</p>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content5 cid-tno5TQgm1m" id="content5-5c">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                
                <h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5"><strong>Conclusion</strong></h4>
                <p class="mbr-text mbr-fonts-style display-7">We believe one of the key takeaways from this project were the use of ansycio library to run multiple steppers at the same time: We found that this python library greatly helped us achieve a smooth and efficient movement. It helped us run PWM signals to the stepper motors simultaneously, so that the gun moved in a diagonal rather than moving solely in the x and y dimensions.<br>Another takeaway was learning so much about integrating software, mechanical, and electrical components of a project and just how difficult it can be. Although with different equipment we probably would have had a much easier time, it also important to be mindful of scoping a project realistically. I do feel however that by shooting for a deliverable that we knew would be very difficult, we accomplished and learned so much more than if we were cautious and picked a simpler idea for the sake of easiness, which we are very proud of.</p>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="image3 cid-tno5UmkZU5" id="image3-5d">
    

    
    

    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="image-wrapper">
                    <img src="assets/images/electronics2-2048x548.jpg" alt="Mobirise Website Builder">
                    
                </div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="footer7 cid-tno9PinLL9" once="footers" id="footer7-5e">

    

    

    <div class="container">
        <div class="media-container-row align-center mbr-white">
            <div class="col-12">
                <p class="mbr-text mb-0 mbr-fonts-style display-7">Carlo Colizzi 2022 - Olin College of Engineering</p>
            </div>
        </div>
    </div>
</section><section class="display-7" style="padding: 0;align-items: center;justify-content: center;flex-wrap: wrap;    align-content: center;display: flex;position: relative;height: 4rem;"><a href="https://mobiri.se/2899369" style="flex: 1 1;height: 4rem;position: absolute;width: 100%;z-index: 1;"><img alt="" style="height: 4rem;" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="></a><p style="margin: 0;text-align: center;" class="display-7">&#8204;</p><a style="z-index:1" href="https://mobirise.com/builder/html-code-generator.html">HTML Code Creator</a></section><script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>  <script src="assets/smoothscroll/smooth-scroll.js"></script>  <script src="assets/ytplayer/index.js"></script>  <script src="assets/dropdown/js/navbar-dropdown.js"></script>  <script src="assets/theme/js/script.js"></script>  
  
  
</body>
</html>